# ๐ Brute Force

> ูุณุฎูโุง ุงุฒ Codexiuo ุจุฑุง ุจุฑูุงููโููุณุงู Express/TS ฺฉู ุง ูุญุงูุธ ูุงู ุง ูู ุฑูุชู ฺฉูุฏุงุดูู ุฑู ุจุง ุขุจ ู ุชุงุจ ูโุจูู!

---

## ๐งจ ุจุฎุด ุงูู: ุญููู Brute Force โ ุฒูุฑ ุจุงุฒู ุฏุฌุชุงู!

### ๐ฃ ฺ ูุณุชุ

ุญูููโุง ฺฉู ุฏุฑ ุงูู ููุงุฌู ุณุน ูโฺฉูู ุจุง ุงูุชุญุงู ฺฉุฑุฏู ุชุนุฏุงุฏ ุฒุงุฏ ุฑูุฒ ุนุจูุฑ ุง ุชูฺฉูุ ูุงุฑุฏ ุณุณุชู ุจุดู.

### ๐งฏ ุฑูุดโูุง ููุงุจูู:

#### 1. Rate Limiting

ูุญุฏูุฏ ฺฉุฑุฏู ุชุนุฏุงุฏ ุชูุงุดโูุง ูุงฺฏู ุฏุฑ ุจุงุฒู ุฒูุงู:

```ts
import rateLimit from "express-rate-limit";

export const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 5,
  message: "ุฒุงุฏ ุชูุงุด ฺฉุฑุฏ! ู ุงุณุชุฑุงุญุช ุจฺฉู...",
});
```

#### 2. Delay on Fail

ุงุถุงูู ฺฉุฑุฏู ุชุฃุฎุฑ ุจุนุฏ ุงุฒ ุชูุงุดโูุง ูุงูููู:

```ts
const failedAttempts: Record<string, number> = {};
await new Promise((r) => setTimeout(r, delayBasedOnFailures(ip)));
```

#### 3. Captcha

ุงูุฒูุฏู Google reCAPTCHA ุง ูุดุงุจู ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฑุจุงุช.

#### 4. Account Lock

ููู ฺฉุฑุฏู ุญุณุงุจ ฺฉุงุฑุจุฑ ุจุนุฏ ุงุฒ ฺูุฏ ุชูุงุด ุงุดุชุจุงู.

#### 5. Logging Suspicious Activity

ูุงูุชูุฑ ฺฉุฑุฏู IPูุง ฺฉู ุฒุงุฏ ุชูุงุด ูโฺฉูู.

---

## ๐ ุจุฎุด ุฏูู: JWT Key Leakage โ ููุช ฺฉูุฏ ูู ุจุฑูุ ุฏุฑ ููู ููโูููู!

### ๐ฐ ุฎุทุฑุงุช ูู ุฑูุชู JWT Secret / Private Key:

| ููุฑุฏ                  | ูพุงูุฏ              |
| --------------------- | ------------------ |
| ุฌุนู ุชูฺฉู              | ุจุง ุฏุณุชุฑุณ admin    |
| ุฌุนู ููุช              | impersonation ฺฉุงูู |
| ุงุฌุงุฏ ุชูฺฉู ุจุฏูู ุงููุถุง | ุจโููุงุช ุฏุณุชุฑุณ    |
| ุฏูุฑ ุฒุฏู auth          | ุจุฏูู ุญุช ุฑูุฒ ุฏุฑุณุช  |

### โ ุฑูุดโูุง ุฌููฺฏุฑ:

- ุฐุฎุฑูโุณุงุฒ ุงูู (env, secret manager)
- ุงุณุชูุงุฏู ุงุฒ ุงูฺฏูุฑุชู RSA (`RS256`) ุจู ุฌุง `HS256`
- ูุฐุงุดุชู ฺฉูุฏูุง ุฏุงุฎู ุณูุฑุณโฺฉุฏ
- Key Rotation ุฏูุฑูโุง
- ุฌููฺฏุฑ ุงุฒ log ุดุฏู Token/Key

---

## ๐งฌ ุจุฎุด ุณูู: `kid` ุฏุฑ JWT โ ูู ฺฉูุฏุ ูู ูุงุชู ุงฺฏู ุฌุฏ ูฺฏุฑุด

### ๐ `kid` ฺุณุชุ

ููุฏ ุฏุฑ ูุฏุฑ JWT ฺฉู ูุดุฎุต ูโฺฉูู ฺฉุฏูู ฺฉูุฏ ุจุงุฏ ุจุฑุง verify ฺฉุฑุฏู ุงุณุชูุงุฏู ุจุดู.

### โ๏ธ ุขุณุจโูพุฐุฑโูุง:

- **Key Confusion**: ุงูุชุฎุงุจ ฺฉูุฏ ุงุดุชุจุงู
- **File Path Injection**: ุจุงุฑฺฏุฐุงุฑ ูุงูโูุง ูุงุฎูุงุณุชู
- **Algorithm Confusion**: ุงุณุชูุงุฏู ุงุฒ `alg: none`

### โ ุฑูุด ุงูู ุงุณุชูุงุฏู:

```ts
const allowedKids = ["key-2024-a", "key-2025-b"];
const kid = decoded?.header?.kid;

if (!allowedKids.includes(kid)) throw new Error("Invalid kid");
const key = keyMap[kid];
jwt.verify(token, key);
```

### ๐ก ุชูุตู ูพุดุฑูุชู:

ุงุณุชูุงุฏู ุงุฒ JWKS ุจุฑุง ูุฏุฑุช ุงูู ฺฉูุฏูุง ุนููู ุฏุฑ ุณุณุชูโูุง ุจุฒุฑฺฏ.

---

## ๐งช TL;DR - ุฌูุนโุจูุฏ ุงููุช Codexiuo

| ุฎุทุฑ             | ุฏูุงุน Codexiuo                                     |
| --------------- | ------------------------------------------------- |
| Brute Force     | Rate limiting, Delay, Captcha, Lock               |
| JWT Leakage     | Secret manager, RS256, Key Rotation               |
| kid Abuse       | Whitelist + Static Key Map + No dynamic file load |
| Token Injection | Reject `alg: none`, no logging tokens             |

---

## โจ ุฑูุฒ ููุง Codexiuo:

> **"ุฑูุฒ ุงุฏููุช ุฑู ุจุง ฺุงู ุฑูุฒ ูฺฏู ุฏุงุฑุ ู ุจฺูโฺฉูุฏ ุฑู ููุท ุจู ุฏุฑ ุฎููุช ูุดูู ุจุฏู!"** ๐๐
