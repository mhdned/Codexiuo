# من بیشتر میدونم و بیشتر میخوام

یه سری اطلاعات هست که می‌خوام خودم داشته باشم، مخصوصاً وقتی با کتابخونه‌ها (Library) و وابستگی‌ها (Dependency) کار می‌کنم و اینا توی typeهاشون نیست یا درست پشتیبانی نمی‌شن.

## داستان چیه؟

مثلاً توی Express، وقتی می‌خوای یه پراپرتی جدید به `Request` اضافه کنی، باید از declaration merging استفاده کنی. اینطوری توی یه فایل `d.ts` (مثلاً `express.d.ts` یا `global.d.ts`) تعریف می‌کنی:

```ts
declare namespace Express {
  export interface Request {
    userId?: string;
  }
}
```

اما اینجا یه مشکل پیش میاد:

🔴 **VS Code** خیلی خوبه و سریع این تغییرات رو می‌بینه.
🟡 **ts-node** لج‌باز بازی درمیاره و تغییرات توی declaration رو نمی‌بینه! مخصوصاً اگه یه بار cache ساخته باشه.

## مشکل چیه؟

`ts-node` معمولاً خروجی فایل‌های `.ts` رو cache می‌کنه. یعنی وقتی فایلی رو اجرا می‌کنی:

- فایل transpile می‌شه و خروجی توی یه مسیر موقتی ذخیره می‌شه.
- اگه دفعه بعد محتوا تغییر نکرده باشه، `ts-node` از cache استفاده می‌کنه.

❌ اما این caching فقط محتوای فایل‌های `.ts` رو چک می‌کنه. تغییرات توی declaration (`.d.ts`) یا حتی `tsconfig.json` رو به صورت پیش‌فرض نمی‌فهمه.

## راه‌حل؟

✅ استفاده از دستور زیر:

```bash
ts-node --files src/index.ts
```

این `--files` باعث می‌شه همه فایل‌هایی که توی `tsconfig` هست (حتی declarationها) خونده بشه و cache رو دوباره بسازه.

✅ یا کلاً cache رو پاک کنی یا پوشه‌ی cache رو پیدا کنی.

✅ یا از پلاگین مثل:

```bash
NODE_OPTIONS="--require ts-node/register --require tsconfig-paths/register" ts-node src/index.ts
```

استفاده کنی.

## جمعبندی

- توی پروژه‌های TypeScript (خصوصاً وقتی Express رو extend می‌کنی)، همیشه حواست به cache `ts-node` باشه.
- VS Code تغییرات رو درست می‌فهمه ولی اجرای واقعی (ts-node یا حتی `tsc`) گاهی به خاطر cache این تغییرات رو نمی‌بینه.
- `--files` رو فراموش نکن!

🟢 حالا راحت می‌تونی پراپرتی‌های دلخواه رو به Express.Request اضافه کنی و بدون دردسر اجرا بگیری! ✨🚀
